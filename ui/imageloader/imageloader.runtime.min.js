TW.Runtime.Widgets.imageloader=function(){function k(a){var d=e.getProperty("debugMode");d&&console.log("ImageLoader - file = "+a.name);if(-1!==".png,.jpeg,.jpg,.gif".indexOf("."+a.name.split(".").pop().toLowerCase())){var c=new FileReader;c.onload=function(){d&&console.log("ImageLoader - file = "+a.name+" loaded");$(".widget-imageloader-"+b).addClass("widget-imageloader-transparent");$(".widget-imageloader-div-"+b).css("background-image","url("+c.result+")");$(".widget-imageloader-span-"+b).css("visibility",
"hidden");e.setProperty("image",c.result.substring(c.result.indexOf(",")+1));e.jqElement.triggerHandler("LoadComplete")};e.jqElement.triggerHandler("LoadStarted");c.readAsDataURL(a)}else e.jqElement.triggerHandler("FilesNotCompatible")}function f(a,b,c,l,f){var d=e.getProperty("debugMode");if(a.dataTransfer.items){var g=[];for(var h=0;h<a.dataTransfer.items.length;h++)"file"===a.dataTransfer.items[h].kind&&g.push(a.dataTransfer.items[h].getAsFile())}else g=a.dataTransfer.files;d&&console.log("FileUploader - "+
b+" - files.length = "+g.length);g&&g.length&&(l&&(a.preventDefault(),a.dataTransfer.dropEffect="copy"),c&&e.jqElement.triggerHandler(c),f&&k(g[0]))}var e=this,b=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),m=TW.Runtime.convertLocalizableString("[[ImageLoaderWidget.imageloader.dragorclick]]","Drag your image here or click in this area");this.runtimeProperties=function(){return{supportsAutoResize:!0,needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-imageloader widget-imageloader-'+
b+'">  <div class="widget-imageloader-div widget-imageloader-div-'+b+'">    <span class="widget-imageloader-span widget-imageloader-span-'+b+'">'+m+'</span>  </div>  <input id="load-image-'+b+'" name="load-image-'+b+'" type="file" style="display:none;"></div>'};this.afterRender=function(){var a=document.getElementById("load-image-"+b);a.setAttribute("accept",".png,.jpeg,.jpg,.gif");a.onchange=function(b){k(a.files[0]);a.value=""};var d=0,c=document.getElementsByClassName("widget-imageloader-div-"+
b)[0];c.ondragenter=function(a){d++;f(a,"ondragenter","OnDragEnter",!1,!1)};c.ondragover=function(a){f(a,"ondragover","",!0,!1)};c.ondragleave=function(a){d--;0===d&&f(a,"ondragleave","OnDragLeave",!1,!1)};c.ondrop=function(a){d=0;f(a,"ondrop","OnDrop",!0,!0)};c.onclick=function(b){b=document.createEvent("MouseEvents");b.initEvent("click",!1,!1);a.dispatchEvent(b)}};this.serviceInvoked=function(a){"Open"===a?(a=document.createEvent("MouseEvents"),a.initEvent("click",!1,!1),document.getElementById("load-image-"+
b).dispatchEvent(a)):"Clear"===a&&($(".widget-imageloader-"+b).removeClass("widget-imageloader-transparent"),$(".widget-imageloader-div-"+b).css("background-image","none"),$(".widget-imageloader-span-"+b).css("visibility","visible"),e.setProperty("image",""))}};